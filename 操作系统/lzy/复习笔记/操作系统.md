# 操作系统期末复习
## 第一章
1. **操作系统的定义**：计算机系统中的一个系统软件，一些程序模块的集合；计算机与用户之间的接口。
2. **操作系统的功能**：文件管理、设备管理、进程管理、存储管理
3. **目态和管态**：管态(内核态)：可以使用所有指令；目态（用户态）：禁止使用特权指令
目态=>管态：系统调用
管态=>目态：修改psw
管态指令:存取IO、更改PSW、存取特殊寄存器（时钟、中断）
4. 操作系统的发展:
- 晶体管和批处理系统：把作业合成一批，放入计算机（不支持交互）
- 多道程序系统：在内存中放多道程序，宏观上并行，微观上串行。**优点**：吞吐量大、资源利用率高
- 分时操作系统：为了满足多用户的需要而设计，共享主机，可以交互
5. **例题**：**见P35.1.6**，这里注意：陷阱是用户态发起系统调用的指令，不属于内核态的指令
## 第二章
### 操作系统的结构
1. 简单结构：如Dos系统，在尽可能小的空间中提供大多数功能
2. 分层结构：每一层只能使用较低层的函数和服务，缺点是效率低
3. 微内核结构：公共部分提供最基本的服务，内核常驻内存，其他部分在用户空间作为服务进程，内核模式下运行的较少。
4. 模块结构：内核模块可加载，模块间通过接口通信，windows保留了微内核的特征，linux新功能可以直接添加到内核。

## 第三章
### 进程的定义
1. 执行中的程序
2. 一个正在执行程序的实例，包括程序计数器、寄存器和变量的当前值
3. 并发执行的程序在执行过程中分配和管理资源的基本单位
### 进程的特征
1. **动态性**：由创建而产生，由调度而执行、由得不到资源而阻塞，由撤销而消亡
2. **并发性**：多个进程可存在内存中，在一段时间内同时运行。
3. **独立性**：独立获得资源的基本单位
4. **异步性**：进程的执行顺序和执行时间的不确定性
### 进程的状态
**就绪态**：已得到除CPU以外的其他资源,被调度进入运行态
**运行态**：占用CPU，时间片用完进入就绪态
**等待态**：I/O或事件的等待
### 进程控制块PCB
**作用**：进程存在的唯一标志
**内容**：描述信息：pid、uid、家族关系 控制信息：当前状态、运行统计时间 资源管理信息：占用内存大小指向文件系统的指针等 CPU保护现场信息：程序计数器、CPU寄存器
**进程创建过程**：
- 查PCB链表，有PCB取新的PCB，填入参数
- PCB入对应的就绪队列
- PCB入对应的进程家族
**进程中止的过程**
级联中止
### fork函数
**返回值**：两个返回值，大于0（子进程的标识号）在父进程中，等于0（可以理解为它的子进程，还没有所以是0）在子进程中。
**子进程的内容**：刚创建时数据复制父进程的数据，子进程已耗费的进程时间设置为0，父子进程可以修改各自数据而互不影响
**wait函数**：父进程等待子进程，子进程运行完之后向父进程的wait函数发一个信号，然后等待子进程先结束，*如果父进程先于子进程运行完，子进程的父进程就变成init进程，称之为孤儿进程*，如果子进程在父进程调用wait之前中止，那父进程就变成*僵尸进程*。
**exec函数**：加载并执行exe文件，以新程序取代子进程的地址空间，*代码段、堆栈段完全重写*
### 进程通信
#### 低级通信：控制信息的交换
##### 锁、信号量、软中断
#### 高级通信：大批量数据的交换
##### 消息机制、管道、共享内存
1. 共享内存：生产者消费者问题
2. 消息通信
3. 管道通信：互斥：一个进程对pipe进行读写时，另一个进程必须等待。同步：管道空时，读进程等待，管道满时，写进程等待。
## 第四章
比进程更小的单位=>[[线程]]
## 第五章
进程的问题=>[[进程同步]]
## 第六章
CPU的调度，如何切换进程在CPU中运行？=>[[CPU调度]]
## 第七章
 [[内存管理]]
 ## 第八章
 [[虚拟内存]]，几个算法记一下就行了
## 第九章
### 文件的基本概念
为了实现共享、和存储大量信息
### 文件系统的特点
- 文件可以按名存取
- 文件可以存储大量信息
- 文件对用户有接口
### 文件的分类
#### 逻辑结构
- 流式，无结构文件
- 记录式，有结构文件
- 树

#### 物理结构
- 顺序结构
	- **逻辑上连续的文件依次存到连续的物理块，目录项包括始址、总块数、最后一块字节数**，类似于数组
- 链接文件
	- **文件信息存储在不连续的物理块中，目录项包含链表的首指针**，类似于链表，**不支持随机存取**
- 索引文件
	- **将文件信息存放在若干不连续的物理块中，然后每个文件建立一张索引表，目录项是索引表的物理地址**
	- 当索引表大小超过一个物理块时，可以采用**多级索引**
### 文件存储设备
#### 顺序存储设备
 **磁带**：存取速度高，是连续文件但是**不支持随机存取**
#### 直接存取设备
**磁盘**：允许直接存取磁盘上的任意物理块，这里要记住磁盘的概念，包括**磁头号、磁道号、扇区号，柱面等**

### 文件目录管理
#### 文件的组成
**文件**=**文件说明FCB（创建的时间、组成目录文件、存在标志灯）+文件体**
#### 目录的组成
- 直接法（win/dos）：**目录项=文件名+FCB**
- 间接法（unix/linux）：**目录项=文件名+FCB地址**

#### 目录结构
- **单级目录**：整个系统一个目录表，**不允许重名**
- **两级目录**：一个主目录表，每个用户有一个用户目录表，**允许重名和文件共享**，**不适合用户太多**
- **树形结构**：**查找速度快，不能实现文件共享**

#### 空闲块存储方法
- **空闲文件目录**
- **空闲块链**
- 位示图

### 第十章
#### linux文件系统和dos文件系统的区别
dos文件系统是多个树的结构、linux是一个目录树的结构
#### 文件详细信息
横线是普通文件，-d是目录文件
三个安全级别分别是：所有者、组、其他用户
三种权限分别是：r、w、x（可执行）
#### linux文件系统
linux向进程提供了一个接口，可以创建各种类型的文件
##### 文件系统的内容
- **引导块**：boot manager
- **超级块**：整个文件系统的信息
- **inode节点表**：/为2号节点，存储文件的属性信息
- **数据区**：存储目录文件，即文件名和inode节点的对应关系、以及普通的数据文件
- **系统打开文件链表**：存放一个已打开文件的管理控制信息，f_node指针指向文件对应的inode
##### 硬链接与软连接
- **硬链接**：加一个指向inode的指针，通过新的文件名也可以访问到它，inode中有一个count，count为0时真正删除
- **软连接**:相当于创建一个新的inode，这个inode指向的文件其实是一个路径，原文件被删除后无法使用，**相当于快捷方式**

##### 进程文件管理
- **fs_struct**:存储文件系统根目录和当前目录，pwd=>相对路径inode，root=>系统根目录inode
- **files_struct**:包含进程的打开文件表，打开文件时，建立一个file结构体，加入系统打开文件表，然后在进程打开文件表中建立一个fd指针指向它，重复打开时，重复此操作
### 第十章
[[设备管理]]

